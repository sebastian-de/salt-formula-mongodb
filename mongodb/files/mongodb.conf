{%- from "mongodb/map.jinja" import server with context %}
# mongodb.conf

# for documentation of all options, see:
#   http://docs.mongodb.org/manual/reference/configuration-options/

systemLog:
  destination: file
  path: /var/log/mongodb/mongod.log
  logAppend: true
storage:
  dbPath: /var/lib/mongodb
  journal:
    enabled: true
net:
  bindIp: {{ server.bind.address }}
  port: {{ server.bind.port }}

security:
  {%- if server.authorization.get('enabled', False) %}
  authorization: enabled
  {%- endif %}
  {%- if server.shared_key is defined %}
  keyFile: /etc/mongodb.key
  {%- endif %}

{%- if server.replica_set is defined %}
replication:
   replSetName: {{ server.replica_set }}
{%- endif %}

setParameter:
   enableLocalhostAuthBypass: true
